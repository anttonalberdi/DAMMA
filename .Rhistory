cor_table <- rbind(cor_table,row)
}
cor_table
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,2))
cor_table <- rbind(cor_table,row)
}
cor_table
cor_table <- as.data.frame(cor_table)
cor_table
Ã§compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table
cor_table[order(cor_table$pvalue),]
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
plot(MCI_filt[,"Pantothenate (B5)"],metadata_filt$chicken_body_weight)
abline(lm(MCI_filt[,"Pantothenate (B5)"] ~ metadata_filt$chicken_body_weight), col = 4, lwd = 3)
abline(metadata_filt$chicken_body_weight) ~ lm(MCI_filt[,"Pantothenate (B5)"], col = 4, lwd = 3)
abline(metadata_filt$chicken_body_weight ~ lm(MCI_filt[,"Pantothenate (B5)"]), col = 4, lwd = 3)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,"Pantothenate (B5)"]), col = 4, lwd = 3)
compound="Triglyceride"
plot(MCI_filt[,compound],metadata_filt$chicken_body_weight)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,compound]), col = 4, lwd = 3)
compound="Keratin"
plot(MCI_filt[,compound],metadata_filt$chicken_body_weight)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,compound]), col = 4, lwd = 3)
compound="L-lactate"
plot(MCI_filt[,compound],metadata_filt$chicken_body_weight)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,compound]), col = 4, lwd = 3)
compound="Ubiquinone (Q10)"
plot(MCI_filt[,compound],metadata_filt$chicken_body_weight)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,compound]), col = 4, lwd = 3)
compound="UDCA"
plot(MCI_filt[,compound],metadata_filt$chicken_body_weight)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,compound]), col = 4, lwd = 3)
compound="Triglyceride"
plot(MCI_filt[,compound],metadata_filt$chicken_body_weight)
abline(lm(metadata_filt$chicken_body_weight ~ MCI_filt[,compound]), col = 4, lwd = 3)
MCI = community_MCI_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
Pantothenate (B5)
#Filter
metadata_filt <- metadata[metadata$sampling_time == 7,]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
MCI = community_MCI_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
Pantothenate (B5)
#Filter
metadata_filt <- metadata[metadata$sampling_time == 21,]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
head(metadata)
metadata$sampling_date <- as.factor(metadata$sampling_date)
cbind(MCI_filt[,c],metadata_filt$chicken_body_weight)
paired <- cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date)
head(paired)
paired <- as.data.frame(cbind(MCI=as.numeric(MCI_filt[,c]),BW=as.numeric(metadata_filt$chicken_body_weight),Date=metadata_filt$sampling_date))
head(paired)
class(paired$MCI)
class(paired$Date)
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
class(paired$Date)
class(paired$MCI)
library(lme4)
MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
summary(MCI_BWA_mixed)
c
attributes(MCI_BWA_mixed)
attributes(MCI_BWA_mixed)
attributes(summary(MCI_BWA_mixed))
summary(MCI_BWA_mixed)$varcor
summary(MCI_BWA_mixed)
confint(MCI_BWA_mixed)
summary(lm(BW ~ MCI, data = paired))
c
cor_table
metadata_filt <- metadata[metadata$sampling_time == 35,]
MCI_filt <- MCI[rownames(metadata_filt),]
c="D-lactate"
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
summary(lm(BW ~ MCI, data = paired))
head(metadata_filt)
summary(lm(BW ~ MCI, data = paired))
summary(lmer(BW ~ MCI + (1 | Date), data = paired))
head(metadata_filt)
#Filter
metadata_filt <- metadata[metadata$sampling_date == "2019-03-11",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
head(metadata_filt)
metadata_filt <- metadata[metadata$sampling_date == "2019-03-12",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
metadata_filt <- metadata[metadata$sampling_date == 35,]
#metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(MCI_filt[,c],metadata_filt$chicken_body_weight)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(BW ~ MCI, data=paired)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
metadata_filt <- metadata[metadata$sampling_date == 35,]
#metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
paired
MCI = community_MCI_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
#Filter
metadata_filt <- metadata[metadata$sampling_date == 35,]
#metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
MCI_filt
MCI = community_MCI_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
#Filter
metadata_filt <- metadata[metadata$sampling_date == 35,]
#metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
head(metadata_filt)
metadata_filt <- metadata[metadata$sampling_time == 35,]
#metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
metadata_filt <- metadata[metadata$sampling_date == "2019-03-13",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
metadata_filt <- metadata[metadata$sampling_date == "2019-03-12",]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
#MCI_BWA_mixed = lmer(BW ~ MCI + (1 | Date), data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
head(metadata_filt)
lm(BW ~ (1 | Trial) + (1 | Date) + MCI, data = paired)
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Date <- as.factor(paired$Date)
lm(BW ~ (1 | Trial) + (1 | Date) + MCI, data = paired)
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
MCI_BWA_mixed = lm(BW ~ (1 | Trial) + (1 | Date) + MCI, data = paired)
MCI_BWA_mixed
MCI_BWA_mixed = lm(BW ~ Trial + Date + MCI, data = paired)
paired
MCI = community_MCI_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
#Filter
metadata_filt <- metadata[metadata$sampling_time == 35,]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
MCI_BWA = lm(BW ~ Trial + Date + MCI, data = paired)
MCI_BWA
summary(MCI_BWA)
c
c="D-lactate"
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
MCI_BWA = lm(BW ~ Trial + Date + MCI, data = paired)
summary(MCI_BWA)
load(community_MCI_caecum,file="community_AB_caecum.RData")
community_MCI_caecum_compounds <- damma_compounds(community_MCI_caecum,pathway_table)
load("community_AB_caecum.RData")
community_MCI_AB_caecum_compounds <- damma_compounds(community_MCI_AB_caecum,pathway_table)
load("distilled_caecum.RData")
annotations_file="annotations_caecum.tsv"
annotations_caecum <- fread(annotations_file)
relabun_caecum <- read.table("/Users/anttonalberdi/github/holofood_damma/relabun_AB_caecum.tsv",row.names=1,header=T)
community_MCI_AB_caecum <- damma_community(annotations_caecum,pathway_table,abundance_table=relabun_caecum,MCI_table=distilled_caecum,genomecol=2,keggcol=9,eccol=c(10,19),pepcol=12)
save(community_MCI_AB_caecum,file="community_AB_caecum.RData")
load("community_AB_caecum.RData")
community_MCI_AB_caecum_compounds <- damma_compounds(community_MCI_AB_caecum,pathway_table)
head(community_MCI_AB_caecum_compounds)
tail(community_MCI_AB_caecum_compounds)
community_MCI_AB_caecum_compounds <- damma_compounds(community_MCI_AB_caecum,pathway_table)
MCI = community_MCI_AB_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
#Filter
metadata_filt <- metadata[metadata$sampling_time == 35,]
MCI_filt <- MCI[rownames(metadata_filt),]
head(MCI_filt)
#Filter
metadata_filt <- metadata[metadata$sampling_time == 35,]
MCI_filt <- MCI[rownames(metadata_filt),]
#Correlation
compounds <- colnames(MCI_filt)
cor_table <- c()
for(c in compounds){
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
#MCI_BWA = lm(BW ~ Trial + Date + MCI, data = paired)
#row <- c(compound=c,cor=summary(MCI_BWA_mixed)$varcor,pvalue=round(test$p.value,3))
test <- cor.test(paired$BW,paired$MCI)
row <- c(compound=c,cor=round(test$estimate,2),pvalue=round(test$p.value,3))
cor_table <- rbind(cor_table,row)
}
cor_table <- as.data.frame(cor_table)
cor_table <- cor_table[order(cor_table$pvalue),]
cor_table
paired$Date
head(metadata_filt)
metadata_filt$sampling_date
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-11"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-12"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-13"] <- 3
metadata_filt$sampling_date
#Filter
metadata_filt <- metadata[metadata$sampling_time == 35,]
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-11"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-12"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-13"] <- 3
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-3"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-4"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-5"] <- 3
MCI_filt <- MCI[rownames(metadata_filt),]
c="Menaquinone (K2)"
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
lm(BW ~ Trial + Date + MCI, data = paired)
summary(lm(BW ~ Trial + Date + MCI, data = paired))
MCI = community_MCI_AB_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
#Filter
metadata_filt <- metadata[metadata$sampling_time == 35,]
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-11"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-12"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-13"] <- 3
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-3"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-4"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-5"] <- 3
MCI_filt <- MCI[rownames(metadata_filt),]
metadata_filt$sampling_date
metadata_filt <- metadata[metadata$sampling_time == 35,]
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-11"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-12"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-03-13"] <- 3
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-03"] <- 1
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-04"] <- 2
metadata_filt$sampling_date[metadata_filt$sampling_date == "2019-06-05"] <- 3
MCI_filt <- MCI[rownames(metadata_filt),]
c="Menaquinone (K2)"
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
summary(lm(BW ~ Trial + Date + MCI, data = paired))
summary(lm(BW ~ MCI, data = paired))
c="Beta-mannan"
paired <- as.data.frame(cbind(MCI=MCI_filt[,c],BW=metadata_filt$chicken_body_weight,Trial=metadata_filt$trial,Date=metadata_filt$sampling_date))
paired$MCI <- as.numeric(paired$MCI)
paired$BW <- as.numeric(paired$BW)
paired$Trial <- as.factor(paired$Trial)
paired$Date <- as.factor(paired$Date)
summary(lm(BW ~ Trial + Date + MCI, data = paired))
nrow(MCI_filt)
load("community_AB_caecum.RData")
community_MCI_AB_caecum_compounds <- damma_compounds(community_MCI_AB_caecum,pathway_table)
MCI = community_MCI_AB_caecum_compounds
metadata <- read.table("/Users/anttonalberdi/github/holofood_damma/metadata.tsv",row.names=1,header=T)
metadata <- metadata[rownames(MCI),]
nrow(metadata)
rownames(MCI_table)
load("community_AB_caecum.RData")
MCI_table <- community_MCI_AB_caecum
rownames(MCI_table) %in% pathway_table$Code
any(rownames(MCI_table) %in% pathway_table$Code)
any(rownames(MCI_table) %in% pathway_table$Compounds)
rownames(MCI_table
)
any(colnames(MCI_table) %in% pathway_table$Code)
colnames(MCI_table)
any(colnames(MCI_table) %in% pathway_table$Compounds)
rowMeans(MCI_table)
library(devtools)
load_all('/Users/anttonalberdi/github/DAMMA')
library(devtools)
load_all('/Users/anttonalberdi/github/DAMMA')
library(devtools)
load_all('/Users/anttonalberdi/github/DAMMA')
help(damma_index)
