D061601	Phenylacetate	Degradation	Xenobiotic degradation	K01912 (K02609+K02610+K02611+K02612+K02613) K15866 K02618 K02615 K01692 K00074
D061701	Trans-cinnamate	Degradation	Xenobiotic degradation	(((K05708+K05709+K05710+K00529) K05711),K05712) K05713 K05714 K02554 K01666 K04073
D061801	Caffeine	Degradation	Xenobiotic degradation	K21722 K21723 K21724
D061901	Mercury	Degradation	Xenobiotic degradation	4.99.1.2 1.16.1.1
D070101	2,3-Butanediol	Degradation	Alcohol degradation	1.1.1.4,1.1.1.76
D070201	Ethanol	Degradation	Alcohol degradation	1.1.1.1 1.2.1.10
D070202	Ethanol	Degradation	Alcohol degradation	1.1.1.1 1.2.1.3 6.2.1.1
D070301	Methanol	Degradation	Alcohol degradation	1.1.1.244 (1.2.146,1.1.1.306) 1.17.98.4
D070401	Glycerol	Degradation	Alcohol degradation	2.7.1.30 1.1.5.3
D070402	Glycerol	Degradation	Alcohol degradation	1.1.1.6 2.7.1.29
D070403	Glycerol	Degradation	Alcohol degradation	4.2.1.30 1.1.1.202
D070404	Glycerol	Degradation	Alcohol degradation	1.1.1.6 2.7.1.121
D070501	Propylene glycol	Degradation	Alcohol degradation	4.2.1.28 (1.1.1.1,(1.2.1.87 2.3.1.222 (2.7.2.1,2.7.2.7,2.7.2.14,2.7.2.15)))
D070601	Ethylene glycol	Degradation	Alcohol degradation	1.1.1.77 1.2.1.21
D070701	Cyclohexanol	Degradation	Alcohol degradation	1.1.1.245 1.14.13.22 1.1.1.258 1.2.1.63
D070801	Phytol	Degradation	Alcohol degradation	1.1.1.1 1.2.1.3 6.2.1.3 1.3.1.38
D070901	Polyvinyl alcohol	Degradation	Alcohol degradation	1.1.2.6
D080101	Nitrate	Degradation	Nitrogen compound degradation	((K00370+K00371+K00374),(K02567+K02568)) ((K00362+K00363),(K03385+K15876))
D080102	Nitrate	Degradation	Nitrogen compound degradation	1.7.5.1 1.7.2.1 1.7.2.5 1.7.2.4
D080103	Nitrate	Degradation	Nitrogen compound degradation	1.9.6.1 1.7.2.2
D080104	Nitrate	Degradation	Nitrogen compound degradation	1.7.1.3 1.7.1.4
D080105	Nitrate	Degradation	Nitrogen compound degradation	1.7.7.2 1.7.7.1
D080201	Hypotaurine	Degradation	Nitrogen compound degradation	2.6.1.77 1.2.1.3
D080301	Taurine	Degradation	Nitrogen compound degradation	2.6.1.77
D080302	Taurine	Degradation	Nitrogen compound degradation	1.4.99.2
D080303	Taurine	Degradation	Nitrogen compound degradation	2.5.1.55
D080401	Urate	Degradation	Nitrogen compound degradation	1.7.3.3 3.5.2.17 4.1.1.97
D080402	Urate	Degradation	Nitrogen compound degradation	1.14.13.113 3.5.2.17 4.1.1.97
B010101	Acetate	Biosynthesis	SCFA biosynthesis	(K00625,K13788,K15024) K00925
B010102	Acetate	Biosynthesis	SCFA biosynthesis	K01905
B010103	Acetate	Biosynthesis	SCFA biosynthesis	K01067
B010104	Acetate	Biosynthesis	SCFA biosynthesis	5.4.3.2 5.4.3.3 1.4.1.11 2.3.1.247 1.3.1.109 2.8.3.9 (2.3.1.9,2.3.1.16) 2.3.1.8 (2.7.2.1,2.7.2.15)
B010105	Acetate	Biosynthesis	SCFA biosynthesis	1.21.4.2 (2.7.2.1,2.7.2.15)
B010106	Acetate	Biosynthesis	SCFA biosynthesis	(1.2.7.1,1.2.1.104) 2.3.1.8 (2.7.2.1,2.7.2.15)
B010201	Butyrate	Biosynthesis	SCFA biosynthesis	1.2.7.1 (2.3.1.9,2.3.1.16) 1.1.1.35 4.2.1.150 1.3.1.109 2.3.1.19 (2.7.2.7,2.7.2.14)
B010202	Butyrate	Biosynthesis	SCFA biosynthesis	2.3.1.8 (2.7.2.1,2.7.2.15) (2.8.3.1,2.8.3.8)
B010203	Butyrate	Biosynthesis	SCFA biosynthesis	(2.3.1.9,2.3.1.16) 1.1.1.36 4.2.1.55 1.3.1.109 (2.8.3.1,2.8.3.8)
B010204	Butyrate	Biosynthesis	SCFA biosynthesis	1.4.1.2 1.1.1.399 2.8.3.12 4.2.1.167 7.2.4.5 1.3.1.109 (2.8.3.1,2.8.3.8)
B010205	Butyrate	Biosynthesis	SCFA biosynthesis	5.4.3.2 5.4.3.3 1.4.1.11 2.3.1.247 1.3.1.109 2.8.3.9
B010206	Butyrate	Biosynthesis	SCFA biosynthesis	2.8.3.18 1.2.1.76 1.1.1.61 2.8.3.M6 4.2.1.120 1.3.1.109 (2.8.3.1,2.8.3.8)
B010207	Butyrate	Biosynthesis	SCFA biosynthesis	1.4.1.2 1.1.1.399 2.8.3.12 4.2.1.167 7.2.4.5 1.3.1.109 (2.8.3.1,2.8.3.8)
B010208	Butyrate	Biosynthesis	SCFA biosynthesis	1.4.1.2 1.1.1.399 2.8.3.12 4.2.1.167 7.2.4.5 1.3.1.109 (2.8.3.1,2.8.3.8)
B010301	Propionate	Biosynthesis	SCFA biosynthesis	(4.2.1.28,1.1.1.1) 1.2.1.87 2.3.1.222 (2.7.2.1,2.7.2.7,2.7.2.14,2.7.2.15)
B010302	Propionate	Biosynthesis	SCFA biosynthesis	4.3.1.19 2.3.1.222 (2.7.2.1,2.7.2.7,2.7.2.14,2.7.2.15)
B010303	Propionate	Biosynthesis	SCFA biosynthesis	5.4.99.2 4.1.1.M5 2.8.3.27
B010304	Propionate	Biosynthesis	SCFA biosynthesis	2.1.3.1 1.1.1.37 4.2.1.2 1.3.5.1 2.8.3.27
B010305	Propionate	Biosynthesis	SCFA biosynthesis	2.8.3.1 4.2.1.54 1.3.1.95 2.8.3.1
B010306	Propionate	Biosynthesis	SCFA biosynthesis	2.6.1.2 1.1.1.28 2.8.3.1 4.2.1.54 1.3.1.95 2.8.3.1
B090101	Indole-3-acetate	Biosynthesis	Indolic compound biosynthesis	1.13.12.3 3.5.1.4
B090102	Indole-3-acetate	Biosynthesis	Indolic compound biosynthesis	4.2.1.84 3.5.1.4
B090103	Indole-3-acetate	Biosynthesis	Indolic compound biosynthesis	3.5.5.1
B090104	Indole-3-acetate	Biosynthesis	Indolic compound biosynthesis	(2.6.1.1,2.6.1.27) 4.1.1.74 1.2.3.7
B090105	Indole-3-acetate	Biosynthesis	Indolic compound biosynthesis	(4.1.1.28,4.1.1.105) 1.4.3.4 1.2.3.7
B090201	Indole-3-propionate	Biosynthesis	Indolic compound biosynthesis	(2.6.1.1,2.6.1.27) 1.1.1.110 (2.8.3.17 3.2.1.175) 1.3.8.15
B090301	indole-3-lactate	Biosynthesis	Indolic compound biosynthesis	(2.6.1.1,2.6.1.27) 1.1.1.110
B020401	L-lactate	Biosynthesis	Organic anion biosynthesis	1.1.1.27
B020402	L-lactate	Biosynthesis	Organic anion biosynthesis	1.1.1.22
B020501	D-lactate	Biosynthesis	Organic anion biosynthesis	1.1.1.28
B020101	Succinate	Biosynthesis	Organic anion biosynthesis	(K01647,K05942) (K01681,K01682) (K00031,K00030) ((((K00164+K00658),K01616)+K00382),(K00174+K00175)) ((K01902+K01903),(K01899+K01900),K18118) ((K00234+K00235+K00236+(K00237,K25801)),(K00239+K00240+K00241),(K00244+K00245+K00246)) (K01676,K01679,(K01677+K01678)) (K00026,K00025,K00024,K00116)
B020102	Succinate	Biosynthesis	Organic anion biosynthesis	((((K00164+K00658),K01616)+K00382),K00174) ((K01902+K01903),(K01899+K01900),K18118) ((K00234+K00235+K00236+(K00237,K25801)),(K00239+K00240+K00241),(K00244+K00245+K00246)) (K01676,K01679,(K01677+K01678)) (K00026,K00025,K00024,K00116)
B020103	Succinate	Biosynthesis	Organic anion biosynthesis	K01580 (K13524,K07250,K00823,K16871) (K00135,K00139,K17761)
B020104	Succinate	Biosynthesis	Organic anion biosynthesis	(K00169+K00170+K00171+K00172) K01007 K01595 K00024 (K01677+K01678) (K00239+K00240) (K01902+K01903) (K15038,K15017) K14465 (K14467,K18861) K14534 K15016 K00626
B020105	Succinate	Biosynthesis	Organic anion biosynthesis	(K02160+K01961+K01962+K01963) K14468 K14469 K15052 K05606 (K01847,(K01848+K01849)) (K14471+K14472) (K00239+K00240+K00241) K01679 K08691 K14449 K14470 K09709
B020106	Succinate	Biosynthesis	Organic anion biosynthesis	(K00169+K00170+K00171+K00172) (K01959+K01960) K00024 (K01677+K01678) (K18209+K18210) (K01902+K01903) (K00174+K00175+K00176+K00177)
B020201	Fumarate	Biosynthesis	Organic anion biosynthesis	(K01647,K05942) (K01681,K01682) (K00031,K00030) ((((K00164+K00658),K01616)+K00382),(K00174+K00175)) ((K01902+K01903),(K01899+K01900),K18118) ((K00234+K00235+K00236+(K00237,K25801)),(K00239+K00240+K00241),(K00244+K00245+K00246)) (K01676,K01679,(K01677+K01678)) (K00026,K00025,K00024,K00116)
B020202	Fumarate	Biosynthesis	Organic anion biosynthesis	((((K00164+K00658),K01616)+K00382),K00174) ((K01902+K01903),(K01899+K01900),K18118) ((K00234+K00235+K00236+(K00237,K25801)),(K00239+K00240+K00241),(K00244+K00245+K00246)) (K01676,K01679,(K01677+K01678)) (K00026,K00025,K00024,K00116)
B020203	Fumarate	Biosynthesis	Organic anion biosynthesis	K01948 K00611 K01940 (K01755,K14681) K01476
B020204	Fumarate	Biosynthesis	Organic anion biosynthesis	(K00815,K00838,K00832,K03334) K00457 K00451 K01800 (K01555,K16171)
B020205	Fumarate	Biosynthesis	Organic anion biosynthesis	K00241+(K00242,K18859,K18860)+K00239+K00240
B020206	Fumarate	Biosynthesis	Organic anion biosynthesis	K00244+K00245+K00246+K00247
B020207	Fumarate	Biosynthesis	Organic anion biosynthesis	(K00169+K00170+K00171+K00172) K01007 K01595 K00024 (K01677+K01678) (K00239+K00240) (K01902+K01903) (K15038,K15017) K14465 (K14467,K18861) K14534 K15016 K00626
B020208	Fumarate	Biosynthesis	Organic anion biosynthesis	(K02160+K01961+K01962+K01963) K14468 K14469 K15052 K05606 (K01847,(K01848+K01849)) (K14471+K14472) (K00239+K00240+K00241) K01679 K08691 K14449 K14470 K09709
B020209	Fumarate	Biosynthesis	Organic anion biosynthesis	(K00169+K00170+K00171+K00172) (K01959+K01960) K00024 (K01677+K01678) (K18209+K18210) (K01902+K01903) (K00174+K00175+K00176+K00177)
B020210	Fumarate	Biosynthesis	Organic anion biosynthesis	(K18029+K18030) K14974 K18028 K15357 K13995 K01799
B020211	Fumarate	Biosynthesis	Organic anion biosynthesis	K00611 K01940 (K01755,K14681)
B020212	Fumarate	Biosynthesis	Organic anion biosynthesis	K22478 K00145 K00821 K09065 K01438 K01940 K01755
B020301	Citrate	Biosynthesis	Organic anion biosynthesis	(K01647,K05942) (K01681,K01682) (K00031,K00030) ((((K00164+K00658),K01616)+K00382),(K00174+K00175)) ((K01902+K01903),(K01899+K01900),K18118) ((K00234+K00235+K00236+(K00237,K25801)),(K00239+K00240+K00241),(K00244+K00245+K00246)) (K01676,K01679,(K01677+K01678)) (K00026,K00025,K00024,K00116)
B020302	Citrate	Biosynthesis	Organic anion biosynthesis	(K01647,K05942) (K01681,K01682) (K00031,K00030)
B020303	Citrate	Biosynthesis	Organic anion biosynthesis	K01647 (K01681,K01682) K01637 (K01638,K19282) (K00026,K00025,K00024)
B020304	Citrate	Biosynthesis	Organic anion biosynthesis	K01647 K01681 K00031 K00261 (K19268+K01846) K04835 K19280 K14449 K19281 K19282 K00024
B100101	Inosinic acid (IMP)	Biosynthesis	Nucleic acid biosynthesis	K00764 (K01945,K11787,K11788,K13713) (K00601,K11175,K08289,K11787,K01492) (K01952,(K23269+K23264+K23265),(K23270+K23265)) (K01933,K11787,(K11788 (K01587,K11808,(K01589 K01588)))) (K01923,K01587,K13713) K01756 (K00602,(K01492,(K06863 K11176)))
B100201	Uridylic acid (UMP)	Biosynthesis	Nucleic acid biosynthesis	(K11540,((K11541 K01465),((K01954,(K01955+K01956)) ((K00609+K00610),K00608) K01465))) (K00226,K00254,K17828) (K13421,(K00762 K01591))
B100301	UDP/UTP	Biosynthesis	Nucleic acid biosynthesis	(K13800,K13809,K09903)
B100401	CDP/CTP	Biosynthesis	Nucleic acid biosynthesis	(K00940,K18533) K01937
B100501	ADP/ATP	Biosynthesis	Nucleic acid biosynthesis	K01939 K01756 (K00939,K18532,K18533,K00944) K00940
B100601	GDP/GTP	Biosynthesis	Nucleic acid biosynthesis	K00088 K01951 K00942 (K00940,K18533)
B030401	Serine	Biosynthesis	Amino acid biosynthesis	K00058 K00831 (K01079,K02203,K22305,K25528)
B030501	Threonine	Biosynthesis	Amino acid biosynthesis	(K00928,K12524,K12525,K12526) K00133 (K00003,K12524,K12525) (K00872,K02204,K02203) K01733
B030601	Cysteine	Biosynthesis	Amino acid biosynthesis	(K00640,K23304) (K01738,K13034,K17069)
B030602	Cysteine	Biosynthesis	Amino acid biosynthesis	(K01697,K10150) K01758
B030603	Cysteine	Biosynthesis	Amino acid biosynthesis	K00789 K17462 K01243 K07173 K17216 K17217
B030701	Methionine	Biosynthesis	Amino acid biosynthesis	(K00928,K12524,K12525) K00133 (K00003,K12524,K12525) (K00651,K00641) K01739 (K01760,K14155) (K00548,K24042,K00549)
B030801	Valine	Biosynthesis	Amino acid biosynthesis	(K01652+(K01653,K11258)) K00053 K01687 K00826
B030901	Isoleucine	Biosynthesis	Amino acid biosynthesis	(K01703+K01704) K00052
B030902	Isoleucine	Biosynthesis	Amino acid biosynthesis	(K17989,K01754) (K01652+(K01653,K11258)) K00053 K01687 K00826
B031001	Leucine	Biosynthesis	Amino acid biosynthesis	K01649 (K01702,(K01703+K01704)) K00052
B031101	Lysine	Biosynthesis	Amino acid biosynthesis	(K00928,K12524,K12525,K12526) K00133 K01714 K00215 K00674 (K00821,K14267) K01439 K01778 (K01586,K12526)
B031102	Lysine	Biosynthesis	Amino acid biosynthesis	K00928 K00133 K01714 K00215 K05822 K00841 K05823 K01778 K01586
B031103	Lysine	Biosynthesis	Amino acid biosynthesis	(K00928,K12524,K12525,K12526) K00133 K01714 K00215 K03340 (K01586,K12526)
B031104	Lysine	Biosynthesis	Amino acid biosynthesis	(K00928,K12524,K12525,K12526) K00133 K01714 K00215 K10206 K01778 (K01586,K12526)
B031105	Lysine	Biosynthesis	Amino acid biosynthesis	K01655 ((K17450 K01705),(K16792+K16793)) K05824
B031106	Lysine	Biosynthesis	Amino acid biosynthesis	K05827 K05828 K05829 K05830 K05831
B031201	Arginine	Biosynthesis	Amino acid biosynthesis	K00611 K01940 (K01755,K14681)
B031202	Arginine	Biosynthesis	Amino acid biosynthesis	K22478 K00145 K00821 K09065 K01438 K01940 K01755
B031301	Proline	Biosynthesis	Amino acid biosynthesis	((K00931 K00147),K12657) K00286
B031401	Glutamate	Biosynthesis	Amino acid biosynthesis	K00673 K01484 K00840 K06447 K05526
B031402	Glutamate	Biosynthesis	Amino acid biosynthesis	K01745 K01712 K01468 (K01479,K00603,K13990,(K05603 K01458))
B031501	Histidine	Biosynthesis	Amino acid biosynthesis	K00765 ((K01523 K01496),K11755,K14152) (K01814,K24017) ((K02501+K02500),K01663) ((K01693 K00817 (K04486,K05602,K18649)),(K01089 K00817)) (K00013,K14152)
B031601	Tryptophan	Biosynthesis	Amino acid biosynthesis	((((K01657+K01658),K13503,K13501,K01656) K00766),K13497) (((K01817,K24017) (K01656,K01609)),K13498,K13501) ((K01695+(K01696,K06001)),K01694)
B031701	Phenylalanine	Biosynthesis	Amino acid biosynthesis	(((K01850,K04092,K14187,K04093,K04516,K06208,K06209) (K01713,K04518,K05359)),K14170) (K00832,K00838)
B031702	Phenylalanine	Biosynthesis	Amino acid biosynthesis	K01850 K15849 K05359
B031801	Tyrosine	Biosynthesis	Amino acid biosynthesis	(((K01850,K04092,K14170,K04093,K04516,K06208,K06209) (K04517,K00211)),K14187) (K00832,K00838)
B031802	Tyrosine	Biosynthesis	Amino acid biosynthesis	(K01850,K04092,K14170) (K00832,K15849) (K00220,K24018,K15227)
B031901	GABA	Biosynthesis	Amino acid biosynthesis	K09470 K09471 K09472 K09473
B032001	Beta-alanine	Biosynthesis	Amino acid biosynthesis	(K00207,(K17722+K17723)) K01464 (K01431,K06016)
B032002	Beta-alanine	Biosynthesis	Amino acid biosynthesis	6.2.1.17 1.3.8.1 4.2.1.116 3.1.2.4 1.1.159 2.6.1.18
B032101	Ornithine	Biosynthesis	Amino acid biosynthesis	(K00618,K00619,K14681,K14682,K00620,K22477,K22478) (((K00930,K22478) K00145),K12659) (K00818,K00821) (K01438,K14677,K00620)
B032102	Ornithine	Biosynthesis	Amino acid biosynthesis	K19412 K05828 K05829 K05830 K05831
B032103	Ornithine	Biosynthesis	Amino acid biosynthesis	2.3.1.1 2.7.2.8 1.2.1.38 2.6.1.11 3.5.1.16
B040101	Choline	Biosynthesis	Amino acid derivative biosynthesis	2.7.7.15 2.7.8.2 3.1.4.4
B040201	Betaine	Biosynthesis	Amino acid derivative biosynthesis	1.1.99.1 1.2.1.8
B040202	Betaine	Biosynthesis	Amino acid derivative biosynthesis	2.1.1.156 2.1.1.157
B040301	Ectoine	Biosynthesis	Amino acid derivative biosynthesis	K00928 K00133 K00836 K06718 K06720
B040401	Ethylene	Biosynthesis	Amino acid derivative biosynthesis	K00789 (K01762,K20772) K05933
B040501	Histamine	Biosynthesis	Amino acid derivative biosynthesis	4.1.1.22
B040601	Creatine	Biosynthesis	Amino acid derivative biosynthesis	K00613 K00542 K00933
B040701	Spermidine	Biosynthesis	Amino acid derivative biosynthesis	(K01583,K01584,K01585,K02626) K01480
B040801	Norspermidine	Biosynthesis	Amino acid derivative biosynthesis	((2.7.2.4 1.2.1.11),(2.6.1.76 4.1.1.86) 1.5.1.43 4.1.1.96
B040901	Putrescine	Biosynthesis	Amino acid derivative biosynthesis	K01476 K01581
B041001	Tryptamine	Biosynthesis	Amino acid derivative biosynthesis	(4.1.1.28,4.1.1.105)
B050101	UDCA	Biosynthesis	Secondary bile acid biosynthesis	1.1.1.159 1.1.1.201
B050201	DCA	Biosynthesis	Secondary bile acid biosynthesis	(3.5.1.24,3.5.1.74) 6.2.1.7 1.1.1.395 1.3.1.115 2.8.3.25 4.2.1.106 1.3.1.114 1.1.152
B050301	LCA	Biosynthesis	Secondary bile acid biosynthesis	(3.5.1.24,3.5.1.74) 6.2.1.7 1.1.1.395 1.3.1.115 2.8.3.25 4.2.1.106 1.3.1.114 1.1.152
B050401	Isodeoxycholate	Biosynthesis	Secondary bile acid biosynthesis	(3.5.1.24,3.5.1.74) 6.2.1.7 1.1.1.395 1.3.1.115 2.8.3.25 4.2.1.106 1.3.1.114 1.1.152 1.1.1.52 1.1.1.391
B050501	Isolithocholate	Biosynthesis	Secondary bile acid biosynthesis	(3.5.1.24,3.5.1.74) 6.2.1.7 1.1.1.395 1.3.1.115 2.8.3.25 4.2.1.106 1.3.1.114 1.1.152 1.1.1.52 1.1.1.391
B060101	Thiamine (B1)	Biosynthesis	Vitamin biosynthesis	(((K03148+K03154) K03151),(K03150 K03149)) K03147 ((K00941 K00788),K14153,K21219) K00946
B060102	Thiamine (B1)	Biosynthesis	Vitamin biosynthesis	(((K03148+K03154) K03151),(K03153 K03149 K10810)) K03147 K00941 K00788 K00946
B060103	Thiamine (B1)	Biosynthesis	Vitamin biosynthesis	(K22699,K03147) ((K00941 (K00788,K21220)),K21219) K00946
B060104	Thiamine (B1)	Biosynthesis	Vitamin biosynthesis	(K00941 K00788),K14153,K21219
B060201	Riboflavin (B2)	Biosynthesis	Vitamin biosynthesis	(((K01497,K14652) ((K01498 K00082),K11752) (K22912,K20860,K20861,K20862,K21063,K21064)),(K02858,K14652)) K00794 K00793 ((K20884 K22949),K11753)
B060301	Niacin (B3)	Biosynthesis	Vitamin biosynthesis	3.6.1.22 (3.2.2.6,3.2.2.4) 3.4.1.19
B060401	Pantothenate (B5)	Biosynthesis	Vitamin biosynthesis	((K00826 K00606 K00077),K01579) (K01918,K13799)
B060402	Pantothenate (B5)	Biosynthesis	Vitamin biosynthesis	((K00606 K00077),(K13367 K00128)) K01918
B060501	Pyridoxal-P (B6)	Biosynthesis	Vitamin biosynthesis	K03472 K03473 K00831 K00097 K03474 K00275
B060502	Pyridoxal-P (B6)	Biosynthesis	Vitamin biosynthesis	K06215 K08681
B060601	Biotin (B7)	Biosynthesis	Vitamin biosynthesis	K00652 (((K00833,K19563) K01935),K19562) K01012
B060602	Biotin (B7)	Biosynthesis	Vitamin biosynthesis	K00652 K25570 K01935 K01012
B060603	Biotin (B7)	Biosynthesis	Vitamin biosynthesis	K16593 K00652 K19563 K01935 K01012
B060604	Biotin (B7)	Biosynthesis	Vitamin biosynthesis	K01906 K00652 (K00833,K19563) K01935 K01012
B060701	Tetrahydrofolate (B9)	Biosynthesis	Vitamin biosynthesis	(K01495,K09007,K22391) (K01077,K01113,(K08310,K19965)) ((K13939,((K13940,(K01633 K00950)) K00796)),(K01633 K13941)) (K11754,K20457) (K00287,K13998)
B060702	Tetrahydrofolate (B9)	Biosynthesis	Vitamin biosynthesis	K14652 K22100 K01633 K13941 K22099 K00287
B060703	Tetrahydrofolate (B9)	Biosynthesis	Vitamin biosynthesis	K01495 K22101 K13941 K11754 K13998
B060801	Cobalamin (B12)	Biosynthesis	Vitamin biosynthesis	(K02302,((K02303,K13542) (K02304,K24866))) (K02190,K03795,K22011) K03394 (K05934,K13541,K21479) K05936 (K02189,K13541) K02188 K05895 ((K02191 K03399),K00595) K06042 K02224
B060802	Cobalamin (B12)	Biosynthesis	Vitamin biosynthesis	(K02303,K13542) (K03394,K13540) K02229 (K05934,K13540,K13541) K05936 K02228 K05895 K00595 K06042 K02224 K02230+K09882+K09883
B060803	Cobalamin (B12)	Biosynthesis	Vitamin biosynthesis	(K00798,K19221) K02232 (K02225,K02227) K02231 K00768 (K02226,K22316) K02233
B060901	Tocopherol/tocotorienol (E)	Biosynthesis	Vitamin biosynthesis	K09833 (K12502,K18534) K09834 K05928
B061001	Phylloquinone (K1)	Biosynthesis	Vitamin biosynthesis	((K02552 K02551 K08680 K02549),K14759) (K01911,K14760) K01661 (K19222,K12073) K23094 K17872 K23095
B061101	Menaquinone (K2)	Biosynthesis	Vitamin biosynthesis	K02552 K02551 K08680 K02549 K01911 K01661 K19222 K02548 K03183
B061102	Menaquinone (K2)	Biosynthesis	Vitamin biosynthesis	K11782 K18285 (K18286,K20810) K11783 K11784 K11785
B061103	Menaquinone (K2)	Biosynthesis	Vitamin biosynthesis	K11782 K18285 K18284 K11784 K11785
B061201	Ubiquinone (Q10)	Biosynthesis	Vitamin biosynthesis	(K03181,K18240) K03179 (K03182+K03186) K18800 K00568 K03185 K03183 (K03184,K06134) K00568
B061202	Ubiquinone (Q10)	Biosynthesis	Vitamin biosynthesis	K06125 K06126 K00591 K06127 K06134 K00591
B070101	Albaflavenone	Biosynthesis	Antibiotic biosynthesis	4.2.3.27 1.14.15.39
B070201	Aurachin	Biosynthesis	Antibiotic biosynthesis	K09460 (K02078+K14245+K14246+K22798) K22799 K22800 K21272 K21271 K22801 K22802
B070301	Aureothin	Biosynthesis	Antibiotic biosynthesis	1.14.99.68 6.2.1.M32 2.3.1.289 2.1.1.353 1.14.15.37
B070401	Bacilysin	Biosynthesis	Antibiotic biosynthesis	K19546 K19547 K19550 K19549 K19548 K13037
B070402	Bacilysin	Biosynthesis	Antibiotic biosynthesis	5.4.99.5 4.1.1.100 5.3.3.19 ((5.3.3.19 1.3.1.aa),1.3.1.aa) 1.1.1.385 6.3.2.49
B070501	Butirosin	Biosynthesis	Antibiotic biosynthesis	6.2.1.39 4.1.1.95 6.2.1.39 1.14.14.13 2.3.2.19 4.3.2.6
B070601	Carbapenem-3-carboxylate	Biosynthesis	Antibiotic biosynthesis	K18317 K18316 K18315
B070701	Cephamycin C	Biosynthesis	Antibiotic biosynthesis	K12743 K04126 K04127 K12744 K12745 K04128 K18062 K18063
B070801	Clavaminate	Biosynthesis	Antibiotic biosynthesis	K12673 K12674 K12675 K12676
B070802	Clavaminate	Biosynthesis	Antibiotic biosynthesis	2.5.1.66 6.3.3.4 1.14.11.21 3.5.3.22 1.14.11.21
B070901	Cycloserine	Biosynthesis	Antibiotic biosynthesis	(K19741 K19723) K19726 (K19725 K19724 K19727)
B070902	Cycloserine	Biosynthesis	Antibiotic biosynthesis	(2.3.1.30,3.5.3.25) 2.6.99.3 5.1.1.19 6.3.3.5
B071001	Dapdiamides	Biosynthesis	Antibiotic biosynthesis	K22113 K01957 K22114
B071002	Dapdiamides	Biosynthesis	Antibiotic biosynthesis	2.7.1.225 2.5.1.140 1.5.1.51 6.3.2.46 (6.3.2.47,(1.14.11.M2 6.3.2.47))
B071101	Erythromycin	Biosynthesis	Antibiotic biosynthesis	2.1.1.254 1.14.13.154
B071102	Erythromycin	Biosynthesis	Antibiotic biosynthesis	2.3.1.94 1.14.15.35 2.4.1.328 2.4.1.278
B071201	Fosfomycin	Biosynthesis	Antibiotic biosynthesis	K23999 K09459 K12901 K12902 K24000 K12903
B071202	Fosfomycin	Biosynthesis	Antibiotic biosynthesis	5.4.2.9 4.1.1.82 1.1.1.309 2.7.7.104 2.1.1.308 1.11.1.23
B071301	Kanamycin	Biosynthesis	Antibiotic biosynthesis	4.2.3.124 2.6.1.100 1.1.1.329 2.6.1.101 2.4.1.283 3.5.1.112 2.4.1.301
B071302	Kanamycin	Biosynthesis	Antibiotic biosynthesis	4.2.3.124 2.6.1.100 1.1.1.329 2.6.1.101 2.4.1.283 3.5.1.112 1.1.3.43 2.6.1.93 2.4.1.301
B071303	Kanamycin	Biosynthesis	Antibiotic biosynthesis	4.2.3.124 2.6.1.100 1.1.1.329 2.6.1.101 2.4.1.284 2.4.1.301
B071304	Kanamycin	Biosynthesis	Antibiotic biosynthesis	4.2.3.124 2.6.1.100 1.1.1.329 2.6.1.101 2.4.1.284 2.6.1.94 2.4.1.301
B071305	Kanamycin	Biosynthesis	Antibiotic biosynthesis	4.2.3.124 2.6.1.100 1.1.1.329 2.6.1.101 2.4.1.283 3.5.1.112 1.1.3.43 2.6.1.93 2.4.1.301 1.1.4.11.37
B071401	Kanosamine	Biosynthesis	Antibiotic biosynthesis	K18652 K18653 K18654
B071402	Kanosamine	Biosynthesis	Antibiotic biosynthesis	1.1.1.361 2.6.1.104 3.1.3.92
B071403	Kanosamine	Biosynthesis	Antibiotic biosynthesis	1.1.1.M53 2.6.1.M10 3.1.4.M4
B071601	Methymycin	Biosynthesis	Antibiotic biosynthesis	2.3.1.239 2.4.1.277 1.14.15.33
B071701	Mupirocin	Biosynthesis	Antibiotic biosynthesis	2.3.1.99 2.3.1.M60 2.3.1.M61 1.14.13.M68 2.3.1.M62 4.2.1.M23 4.1.1.M16 1.13.12.M4 2.3.1.M62 6.3.2.M13 1.14.15.M8 3.1.2.M5 4.2.1.M24 1.1.1.M50 1.1.1.M51
B071801	Naphthomycin	Biosynthesis	Antibiotic biosynthesis	6.2.1.74 1.14.13.M73 2.3.1.M75 1.14.19.M25
B071901	Neomycin	Biosynthesis	Antibiotic biosynthesis	2.4.1.285 3.5.1.113 1.1.3.44 2.6.1.95
B072001	Nocardicin A	Biosynthesis	Antibiotic biosynthesis	(K19102+K19103+K05375) K19104 K19105 K19106
B072101	Novobiocin	Biosynthesis	Antibiotic biosynthesis	6.3.1.15 2.1.1.284 2.4.1.302 2.1.1.285 2.1.3.12
B072201	Paromamine	Biosynthesis	Antibiotic biosynthesis	4.2.3.124 2.6.1.100 (1.1.1.329,1.1.99.38) 2.6.1.101 2.4.1.283 3.5.1.112
B072301	Penicillin	Biosynthesis	Antibiotic biosynthesis	K12743 K04126 K10852
B072302	Penicillin	Biosynthesis	Antibiotic biosynthesis	6.3.2.26 1.21.3.1
B072401	Pentalenolactone	Biosynthesis	Antibiotic biosynthesis	K12250 K15907 K18056 K17747 K18091 K18057 K17476
B072402	Pentalenolactone	Biosynthesis	Antibiotic biosynthesis	4.2.3.7 1.4.15.32 1.14.11.35 1.1.1.340 1.14.13.170 1.14.11.36 1.14.19.8
B072501	Pikromycin	Biosynthesis	Antibiotic biosynthesis	2.3.1.240 2.4.1.277 1.14.15.33
B072601	Prodigiosin	Biosynthesis	Antibiotic biosynthesis	((K21780+K21781) K21782 K21783 K21784 K21785 K21786) (K21428 K21778 K21779) K21787
B072701	Puromycin	Biosynthesis	Antibiotic biosynthesis	K12628 K12629 K12630 K12631 K12632 K12633 K12634 K12635 K12636
B072801	Pyocyanin	Biosynthesis	Antibiotic biosynthesis	K13063 K20261 K06998 K20260 K20262 K21103 K20940
B072802	Pyocyanin	Biosynthesis	Antibiotic biosynthesis	2.1.1.327 1.14.13.218
B072901	Pyrrolnitrin	Biosynthesis	Antibiotic biosynthesis	K14266 K19981 K14257 K19982
B073001	Rebeccamycin	Biosynthesis	Antibiotic biosynthesis	K14266 K19884 K19885 (K19886+K19887) K19888 K19889
B073002	Rebeccamycin	Biosynthesis	Antibiotic biosynthesis	1.14.19.9 1.4.3.23 1.21.98.2 1.13.12.17 4.3.3.5 2.1.1.164
B073101	Ribostamycin	Biosynthesis	Antibiotic biosynthesis	1.1.3.43 2.6.1.93 2.4.2.49 3.1.3.88
B073201	Roseoflavin	Biosynthesis	Antibiotic biosynthesis	K22598 K22269
B073202	Roseoflavin	Biosynthesis	Antibiotic biosynthesis	2.7.1.26 2.6.1.114 2.1.1.343
B073301	Spectinabilin	Biosynthesis	Antibiotic biosynthesis	1.14.99.68 6.2.1.M32 2.3.1.290 2.1.1.353 1.14.15.37
B073401	Staurosporine	Biosynthesis	Antibiotic biosynthesis	K20075 K20076 (K20077+K20078) K20079 K20080 K20081 K20082
B073501	Streptozotocin	Biosynthesis	Antibiotic biosynthesis	2.1.1.381 1.14.13.250
B073601	Sulfazecin	Biosynthesis	Antibiotic biosynthesis	((2.7.1.225 2.5.1.140 1.5.1.51 6.2.1.M42),6.2.1.M41,6.2.1.67) 2.8.2.M5 1.14.11.M37 2.1.1.M98
B073701	Terpentecin	Biosynthesis	Antibiotic biosynthesis	K19835 K19834
B073801	Tetracycline	Biosynthesis	Antibiotic biosynthesis	1.14.13.232 1.14.13.233 2.6.1.M2 2.1.1.335 1.14.13.38 1.3.98.4
B073901	Trienomycin	Biosynthesis	Antibiotic biosynthesis	(((5.1.1.5,5.1.1.10) 6.2.1.54),(6.2.1.74 2.3..1.M77 2.3.1.M78 2.1.1.M52)) 2.3.2.v 2.3.1.dp
B074001	Tunicamycin	Biosynthesis	Antibiotic biosynthesis	((4.2.1.M11 5.1.3.M3),(3.6.1.9 3.1.3.5)) 4.1.99.M2 3.6.1.M1 2.4.1.M16 3.5.1.M4 2.3.1.M33
B074101	Validamycin A	Biosynthesis	Antibiotic biosynthesis	K19969 K20431 K20432 K20433 K20434 K20435 K20436 K20437 K20438
B074102	Validamycin A	Biosynthesis	Antibiotic biosynthesis	4.2.3.152 5.1.3.33 2.7.1.214 (2.6.1.M1,2.7.7.91) 2.5.1.135 3.1.3.101 2.4.1.338 1.14.11.52
B074201	Violacein	Biosynthesis	Antibiotic biosynthesis	K20086 (K20087+K20088) K20089 K20090
B074202	Violacein	Biosynthesis	Antibiotic biosynthesis	1.4.3.23 1.21.98.2 1.14.13.217 1.14.13.224
B120101	Acarbose	Biosynthesis	Secondary metabolite biosynthesis	K19969 K19979 K19974 K20424 K20425 K20426 K20427 K20430
B120201	Undecylprodigiosin	Biosynthesis	Secondary metabolite biosynthesis	((K21780+K21781) K21782 K21783 K21784 K21785 K21786) (K21791 K21792 K21793) K21787
B120301	Cyclooctatin	Biosynthesis	Secondary metabolite biosynthesis	K13787 K18686 K22997 K22998
B120302	Cyclooctatin	Biosynthesis	Secondary metabolite biosynthesis	4.2.3.146 1.14.99.61 1.14.99.62
B120401	Grixazone	Biosynthesis	Secondary metabolite biosynthesis	K18287 K17835 K20204
B120402	Grixazone	Biosynthesis	Secondary metabolite biosynthesis	2.7.2.4 1.2.1.11 4.1.2.56 4.1.99.20 1.10.3.15
B120501	Ethynylserine	Biosynthesis	Secondary metabolite biosynthesis	K23669 K23670 K23671 K23672 K23673
B110101	Staphyloferrin	Biosynthesis	Metallophore biosynthesis	K21898 K23446 K23447
B110102	Staphyloferrin	Biosynthesis	Metallophore biosynthesis	(5.1.1.10,5.1.1.12) 6.3.2.58 6.3.2.57
B110103	Staphyloferrin	Biosynthesis	Metallophore biosynthesis	K23371 K21949 K21721 K23372 K23373 K23374 K23375
B110104	Staphyloferrin	Biosynthesis	Metallophore biosynthesis	2.7.1.225 2.5.1.140 1.5.1.51 6.3.2.54 4.1.1.117 6.3.2.55 6.3.2.56
B110201	Aerobactin	Biosynthesis	Metallophore biosynthesis	K03897 K03896 K03894 K03895
B110202	Aerobactin	Biosynthesis	Metallophore biosynthesis	1.14.13.59 2.3.1.102 6.3.2.38 6.3.2.39
B110301	Staphylopine	Biosynthesis	Metallophore biosynthesis	(5.1.1.10,5.1.1.24) 2.5.1.152 1.5.1.52
B080101	Salicylate	Biosynthesis	Aromatic compound biosynthesis	5.4.4.2 4.2.99.21
B080201	Gallate	Biosynthesis	Aromatic compound biosynthesis	4.2.1.10
B080301	Chorismate	Biosynthesis	Aromatic compound biosynthesis	4.2.1.10 1.1.1.25 2.7.1.71 2.5.1.19 4.2.3.5
B080302	Chorismate	Biosynthesis	Aromatic compound biosynthesis	2.5.1.54 3.2.3.4 4.2.1.10 1.1.1.25 2.7.1.71 2.5.1.19 4.2.3.5
B080303	Chorismate	Biosynthesis	Aromatic compound biosynthesis	2.7.2.4 1.2.1.11 2.2.1.10 1.4.1.24 4.2.1.10 1.1.1.25 2.7.1.71 2.5.1.19 4.2.3.5
B080404	Dipicolinate	Biosynthesis	Aromatic compound biosynthesis	2.7.2.4 1.2.1.11 4.3.3.7
gene_annotations <- read.table("data/source/gene_annotations.tsv",header=TRUE,sep="\t")
library(gtools)
gene_annotations <- gene_annotations[mixedorder(gene_annotations$genome),]
gene_expression <- read.table("data/source/gene_expression.tsv",header=TRUE,sep="\t",row.names=1)
genome_counts <- read.table("data/source/genome_counts.tsv",header=TRUE,sep="\t",row.names=1)
genome_quality <- read.table("data/source/genome_quality.tsv",header=TRUE,sep="\t")
pathway_table_FD1 <- read.table("data/source/DAMMA_db1.tsv",header=TRUE,sep="\t")
pathway_table_FD2 <- read.table("data/source/DAMMA_db2.tsv",header=TRUE,sep="\t")
pathway_table_FD3 <- read.table("data/source/DAMMA_db3.tsv",header=TRUE,sep="\t")
pathway_table_FD4 <- read.table("data/source/DAMMA_db4.tsv",header=TRUE,sep="\t")
pathway_table_FD5 <- read.table("data/source/DAMMA_db5.tsv",header=TRUE,sep="\t")
pathway_table_FD6 <- read.table("data/source/DAMMA_db6.tsv",header=TRUE,sep="\t")
pathway_table_FD7 <- read.table("data/source/DAMMA_db7.tsv",header=TRUE,sep="\t")
#Use latest version as default
pathway_table <- pathway_table_FD6
save(pathway_table,gene_annotations,gene_expression,genome_counts,genome_quality,
pathway_table_FD1,
pathway_table_FD2,
pathway_table_FD3,
pathway_table_FD4,
pathway_table_FD5,
pathway_table_FD6,
pathway_table_FD7,
file="data/damma_data.RData")
#Set workind directory
setwd("/Users/anttonalberdi/github/functional_diversity/")
library(devtools)
library(data.table)
#Load local DAMMA
load_all('/Users/anttonalberdi/github/DAMMA')
#Load annotations
gene_annotations <- fread("data/annotations1.tsv")
#Run distillation
MCI_table <- damma(gene_annotations,pathway_table_FD7,genomecol=2,keggcol=9,eccol=c(10,19),pepcol=12)
save(MCI_table,file="MCI_table1.Rdata")
MCI_table_compounds <- damma_compounds(MCI_table,pathway_table_FD7)
#Count non-zero percentage
round(colSums(MCI_table_compounds!=0)/nrow(MCI_table_compounds)*100,2)
library(data.table)
library(ggplot2)
library(RColorBrewer)
#Prepare input table
compounds_table_df <- melt(MCI_table_compounds)
colnames(compounds_table_df) <- c("MAGs","Compounds","MCI")
compounds_table_df2 <- merge(compounds_table_df,pathway_table_FD7,by.x="Compounds",by.y="Compound")
compounds_table_df2$Function <- as.factor(compounds_table_df2$Function)
#Plot heatmap
pdf("compounds.pdf",width=8,height=12)
ggplot(compounds_table_df2, aes(x=MAGs, y=Compounds, fill=MCI, group=Function))+
geom_tile()+
scale_y_discrete(guide = guide_axis(check.overlap = TRUE))+
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))+
#scale_fill_gradientn(limits = c(0,1), colours = rev(c("#781a25","#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#ddf1da","#f1faf0","#f4f4f4")))+
scale_fill_gradientn(limits = c(0,1), colours=brewer.pal(7, "YlGnBu"))+
facet_grid(Function ~ ., scales = "free", space = "free")+
theme_grey(base_size=8)+
theme(strip.text.y = element_text(angle = 0),axis.text.x=element_blank())
dev.off()
round(colSums(MCI_table!=0)/nrow(MCI_table)*100,2)
©
setwd("/Users/anttonalberdi/github/functional_diversity/")
load("MCI_table1.Rdata")
round(colSums(MCI_table!=0)/nrow(MCI_table)*100,2)
setwd("/Users/anttonalberdi/github/holofood_damma_metatranscriptomics/")
load("distilled_caecum_1.RData")
load("distilled_caecum_2.RData")
load("distilled_caecum_3.RData")
load("distilled_caecum_4.RData")
load("distilled_caecum_5.RData")
load("distilled_caecum_6.RData")
load("distilled_caecum_7.RData")
load("distilled_caecum_8.RData")
distilled_expression_caecum <- c(distilled_expression_caecum_1,distilled_expression_caecum_2,distilled_expression_caecum_3,distilled_expression_caecum_4,distilled_expression_caecum_5,distilled_expression_caecum_6,distilled_expression_caecum_7,distilled_expression_caecum_8)
distilled_expression_caecum_merged <- Reduce("+", distilled_expression_caecum)
#Aggregate to compounds
distilled_expression_caecum_merged_compounds <- damma_compounds(distilled_expression_caecum_merged,pathway_table_FD6)
distilled_expression_caecum_merged_compounds <- distilled_expression_caecum_merged_compounds[sort(rownames(distilled_expression_caecum_merged_compounds)),]
load_all('/Users/anttonalberdi/github/DAMMA')
library(devtools)
load_all('/Users/anttonalberdi/github/DAMMA')
distilled_expression_caecum_merged_compounds <- damma_compounds(distilled_expression_caecum_merged,pathway_table_FD6)
distilled_expression_caecum_merged_compounds <- distilled_expression_caecum_merged_compounds[sort(rownames(distilled_expression_caecum_merged_compounds)),]
library(data.table)
library(ggplot2)
library(RColorBrewer)
#Prepare input table
compounds_table_df <- melt(distilled_expression_caecum_merged_compounds)
colnames(compounds_table_df) <- c("Samples","Compounds","MCI")
compounds_table_df$Samples <- gsub("F1a","",compounds_table_df$Samples)
compounds_table_df2 <- merge(compounds_table_df,unique(pathway_table_FD6[,c("Compound","Function")]),by.x="Compounds",by.y="Compound")
metadata <- read.table("metadata.tsv",row.names=1,header=T)
compounds_table_df2 <- merge(compounds_table_df2,metadata,by.x="Samples",by.y="row.names")
compounds_table_df2$trial_time <- paste(compounds_table_df2$trial,compounds_table_df2$sampling_time,sep="_")
compounds_table_df2$trial_time <- as.factor(compounds_table_df2$trial_time)
compounds_table_df2$trial_time <- factor(compounds_table_df2$trial_time, levels=c("CA_7","CB_7","CA_21","CB_21","CA_35","CB_35","CC_7","CC_21","CC_35"))
compounds_table_df2$Function <- as.factor(compounds_table_df2$Function)
compounds_table_df2$Function <- factor(compounds_table_df2$Function, levels=c("Polysaccharide degradation","Sugar degradation","Lipid degradation","Protein degradation","Mucin degradation","SCFA production","Organic anion production","Secondary bile acid production","Amino acid production","Amino acid derivative production","Vitamin production"))
compounds_table_df2$MCI <- log(compounds_table_df2$MCI)
compounds_table_df2$MCI[which(!is.finite(compounds_table_df2$MCI))] <- NA
max=max(compounds_table_df2$MCI)
min=min(compounds_table_df2$MCI)
#Plot heatmap
ggplot(compounds_table_df2, aes(x=Samples, y=Compounds, fill=MCI, group=Function))+
geom_tile(colour="white", size=0.1)+
scale_y_discrete(guide = guide_axis(check.overlap = TRUE))+
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))+
#scale_fill_gradientn(limits = c(0,1), colours = rev(c("#781a25","#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#ddf1da","#f1faf0","#f4f4f4")))+
scale_fill_gradientn(limits = c(min,max), colours=brewer.pal(7, "YlGnBu"))+
facet_grid(Function ~ ., scales = "free", space = "free")+
theme_grey(base_size=8)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
gene_annotations <- read.table("data/source/gene_annotations.tsv",header=TRUE,sep="\t")
library(gtools)
gene_annotations <- gene_annotations[mixedorder(gene_annotations$genome),]
gene_expression <- read.table("data/source/gene_expression.tsv",header=TRUE,sep="\t",row.names=1)
genome_counts <- read.table("data/source/genome_counts.tsv",header=TRUE,sep="\t",row.names=1)
genome_quality <- read.table("data/source/genome_quality.tsv",header=TRUE,sep="\t")
pathway_table_FD1 <- read.table("data/source/DAMMA_db1.tsv",header=TRUE,sep="\t")
pathway_table_FD2 <- read.table("data/source/DAMMA_db2.tsv",header=TRUE,sep="\t")
pathway_table_FD3 <- read.table("data/source/DAMMA_db3.tsv",header=TRUE,sep="\t")
pathway_table_FD4 <- read.table("data/source/DAMMA_db4.tsv",header=TRUE,sep="\t")
pathway_table_FD5 <- read.table("data/source/DAMMA_db5.tsv",header=TRUE,sep="\t")
pathway_table_FD6 <- read.table("data/source/DAMMA_db6.tsv",header=TRUE,sep="\t")
pathway_table_FD7 <- read.table("data/source/DAMMA_db7.tsv",header=TRUE,sep="\t")
#Use latest version as default
pathway_table <- pathway_table_FD6
save(pathway_table,gene_annotations,gene_expression,genome_counts,genome_quality,
pathway_table_FD1,
pathway_table_FD2,
pathway_table_FD3,
pathway_table_FD4,
pathway_table_FD5,
pathway_table_FD6,
pathway_table_FD7,
file="data/damma_data.RData")
library(devtools)
load_all('/Users/anttonalberdi/github/DAMMA')
setwd("/Users/anttonalberdi/github/functional_diversity/")
library(devtools)
library(data.table)
#Load local DAMMA
load_all('/Users/anttonalberdi/github/DAMMA')
#Load annotations
gene_annotations <- fread("data/annotations1.tsv")
#Run distillation
MCI_table <- damma(gene_annotations,pathway_table_FD7,genomecol=2,keggcol=9,eccol=c(10,19),pepcol=12)
save(MCI_table,file="MCI_table1.Rdata")
MCI_table_compounds <- damma_compounds(MCI_table,pathway_table_FD7)
#Count non-zero compound percentage
round(colSums(MCI_table_compounds!=0)/nrow(MCI_table_compounds)*100,2)
library(data.table)
library(ggplot2)
library(RColorBrewer)
#Prepare input table
compounds_table_df <- melt(MCI_table_compounds)
colnames(compounds_table_df) <- c("MAGs","Compounds","MCI")
compounds_table_df2 <- merge(compounds_table_df,pathway_table_FD7,by.x="Compounds",by.y="Compound")
compounds_table_df2$Function <- as.factor(compounds_table_df2$Function)
#Plot heatmap
pdf("compounds.pdf",width=8,height=18)
ggplot(compounds_table_df2, aes(x=MAGs, y=Compounds, fill=MCI, group=Function))+
geom_tile()+
scale_y_discrete(guide = guide_axis(check.overlap = TRUE))+
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))+
#scale_fill_gradientn(limits = c(0,1), colours = rev(c("#781a25","#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#ddf1da","#f1faf0","#f4f4f4")))+
scale_fill_gradientn(limits = c(0,1), colours=brewer.pal(7, "YlGnBu"))+
facet_grid(Function ~ ., scales = "free", space = "free")+
theme_grey(base_size=8)+
theme(strip.text.y = element_text(angle = 0),axis.text.x=element_blank())
dev.off()
gene_annotations <- read.table("data/source/gene_annotations.tsv",header=TRUE,sep="\t")
library(gtools)
gene_annotations <- gene_annotations[mixedorder(gene_annotations$genome),]
gene_expression <- read.table("data/source/gene_expression.tsv",header=TRUE,sep="\t",row.names=1)
genome_counts <- read.table("data/source/genome_counts.tsv",header=TRUE,sep="\t",row.names=1)
genome_quality <- read.table("data/source/genome_quality.tsv",header=TRUE,sep="\t")
pathway_table_FD1 <- read.table("data/source/DAMMA_db1.tsv",header=TRUE,sep="\t")
pathway_table_FD2 <- read.table("data/source/DAMMA_db2.tsv",header=TRUE,sep="\t")
pathway_table_FD3 <- read.table("data/source/DAMMA_db3.tsv",header=TRUE,sep="\t")
pathway_table_FD4 <- read.table("data/source/DAMMA_db4.tsv",header=TRUE,sep="\t")
pathway_table_FD5 <- read.table("data/source/DAMMA_db5.tsv",header=TRUE,sep="\t")
pathway_table_FD6 <- read.table("data/source/DAMMA_db6.tsv",header=TRUE,sep="\t")
pathway_table_FD7 <- read.table("data/source/DAMMA_db7.tsv",header=TRUE,sep="\t")
#Use latest version as default
pathway_table <- pathway_table_FD6
save(pathway_table,gene_annotations,gene_expression,genome_counts,genome_quality,
pathway_table_FD1,
pathway_table_FD2,
pathway_table_FD3,
pathway_table_FD4,
pathway_table_FD5,
pathway_table_FD6,
pathway_table_FD7,
file="data/damma_data.RData")
gene_annotations <- read.table("data/source/gene_annotations.tsv",header=TRUE,sep="\t")
library(gtools)
gene_annotations <- gene_annotations[mixedorder(gene_annotations$genome),]
gene_expression <- read.table("data/source/gene_expression.tsv",header=TRUE,sep="\t",row.names=1)
genome_counts <- read.table("data/source/genome_counts.tsv",header=TRUE,sep="\t",row.names=1)
genome_quality <- read.table("data/source/genome_quality.tsv",header=TRUE,sep="\t")
pathway_table_FD1 <- read.table("data/source/DAMMA_db1.tsv",header=TRUE,sep="\t")
pathway_table_FD2 <- read.table("data/source/DAMMA_db2.tsv",header=TRUE,sep="\t")
pathway_table_FD3 <- read.table("data/source/DAMMA_db3.tsv",header=TRUE,sep="\t")
pathway_table_FD4 <- read.table("data/source/DAMMA_db4.tsv",header=TRUE,sep="\t")
pathway_table_FD5 <- read.table("data/source/DAMMA_db5.tsv",header=TRUE,sep="\t")
pathway_table_FD6 <- read.table("data/source/DAMMA_db6.tsv",header=TRUE,sep="\t")
pathway_table_FD7 <- read.table("data/source/DAMMA_db7.tsv",header=TRUE,sep="\t")
#Use latest version as default
pathway_table <- pathway_table_FD7
save(pathway_table,gene_annotations,gene_expression,genome_counts,genome_quality,
pathway_table_FD1,
pathway_table_FD2,
pathway_table_FD3,
pathway_table_FD4,
pathway_table_FD5,
pathway_table_FD6,
pathway_table_FD7,
file="data/damma_data.RData")
setwd("/Users/anttonalberdi/github/functional_diversity/")
library(devtools)
library(data.table)
#Load local DAMMA
load_all('/Users/anttonalberdi/github/DAMMA')
#Load annotations
gene_annotations <- fread("data/annotations1.tsv")
#Run distillation
MCI_table <- damma(gene_annotations,pathway_table_FD7,genomecol=2,keggcol=9,eccol=c(10,19),pepcol=12)
save(MCI_table,file="MCI_table1.Rdata")
#Count non-zero pathway percentage
round(colSums(MCI_table!=0)/nrow(MCI_table)*100,2)
MCI_table_compounds <- damma_compounds(MCI_table,pathway_table_FD7)
#Count non-zero compound percentage
round(colSums(MCI_table_compounds!=0)/nrow(MCI_table_compounds)*100,2)
library(data.table)
library(ggplot2)
library(RColorBrewer)
#Prepare input table
compounds_table_df <- melt(MCI_table_compounds)
colnames(compounds_table_df) <- c("MAGs","Compounds","MCI")
compounds_table_df2 <- merge(compounds_table_df,pathway_table_FD7,by.x="Compounds",by.y="Compound")
compounds_table_df2$Function <- as.factor(compounds_table_df2$Function)
#Plot heatmap
pdf("compounds.pdf",width=8,height=18)
ggplot(compounds_table_df2, aes(x=MAGs, y=Compounds, fill=MCI, group=Function))+
geom_tile()+
scale_y_discrete(guide = guide_axis(check.overlap = TRUE))+
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))+
#scale_fill_gradientn(limits = c(0,1), colours = rev(c("#781a25","#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#ddf1da","#f1faf0","#f4f4f4")))+
scale_fill_gradientn(limits = c(0,1), colours=brewer.pal(7, "YlGnBu"))+
facet_grid(Function ~ ., scales = "free", space = "free")+
theme_grey(base_size=8)+
theme(strip.text.y = element_text(angle = 0),axis.text.x=element_blank())
dev.off()
head(MCI_table)
t(as.data.frame(t(MCI_table)) %>%
rownames_to_column('Code') %>%
left_join(pathway_table[,c('Code', 'Compound')], by = 'Code') %>%
group_by(Compound,Function) %>%
summarise(across(where(is.numeric), ~ max(.x, na.rm = TRUE))) %>%
arrange(factor(Compound, levels = unique(pathway_table$Compound))) %>%
column_to_rownames('Compound'))
head(pathway_table)
head(MCI_table)
t(as.data.frame(t(MCI_table)) %>%
rownames_to_column('Code') %>%
left_join(pathway_table[,c('Code', 'Compound', 'Function')], by = 'Code') %>%
group_by(Compound,Function) %>%
summarise(across(where(is.numeric), ~ max(.x, na.rm = TRUE))) %>%
arrange(factor(Compound, levels = unique(pathway_table$Compound))) %>%
column_to_rownames('Compound'))
